generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

// ---------------------------------------------------------------------------
// MySQL (opcional)
// Para usar MySQL en lugar de SQLite:
// 1) Asegúrate de tener una base MySQL accesible.
// 2) Actualiza la variable DATABASE_URL en el archivo `.env` con la cadena
//    de conexión MySQL: mysql://USER:PASSWORD@HOST:PORT/DATABASE
// 3) Reemplaza el bloque `datasource db { ... }` anterior por este (o descomenta
//    y ajusta):
// datasource db {
//   provider = "mysql"
//   url      = env("DATABASE_URL")
// }
// 4) Ejecuta `npx prisma generate` y `npx prisma migrate dev --name init` para
//    crear las tablas en MySQL.
// ---------------------------------------------------------------------------
model usuarios {
  id         Int          @id @default(autoincrement())
  nombre     String?
  apellidos  String?
  email      String?      @unique
  password   String?
  activo     Int?         @default(1)
  documentos documentos[]
  bitacora   bitacora[]
  roles      usuario_roles[]
}

model documentos {
  id           Int       @id @default(autoincrement())
  nombre       String?
  descripcion  String?
  mime         String?
  ruta         String?
  usuarios_id  Int?
  fecha_subida DateTime? @default(now())
  usuarios     usuarios? @relation(fields: [usuarios_id], references: [id])
}

model tipos_documentos {
  id   Int     @id @default(autoincrement())
  tipo String?
}

model roles {
  id          Int             @id @default(autoincrement())
  name        String          @unique
  descripcion String?
  usuarios    usuario_roles[]
}

model usuario_roles { 
  usuario_id Int
  role_id    Int
  usuario    usuarios @relation(fields: [usuario_id], references: [id])
  role       roles    @relation(fields: [role_id], references: [id])

  @@id([usuario_id, role_id])
}

model bitacora {
  id           Int      @id @default(autoincrement())
  usuario_id   Int?
  rol          String?
  accion       String
  detalles     String?
  fecha_inicio DateTime @default(now())
  usuarios     usuarios? @relation(fields: [usuario_id], references: [id])
}